<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LKPD: Misteri Tagihan Listrik </title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Fredoka:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
</head>
<body>

    <div class="container">
        <header class="main-header" style="background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);">
            <div class="logo-area">
                <i class="fa-solid fa-bolt fa-3x" style="color: white;"></i>
                <div style="margin-left: 15px; display: flex; flex-direction: column; justify-content: center;">
                    <h1 style="margin: 0; line-height: 1.1; font-size: 1.8rem;">LKPD: Persamaan Garis Lurus</h1>
                    <p style="margin: 2px 0 0 0; color: white; font-size: 0.95rem; opacity: 0.9;">Kasus: Tagihan Listrik Pak Andi</p>
                </div>
            </div>
            
            <div class="student-info">
                <div class="input-group" style="margin-bottom: 8px;">
                    <i class="fa-solid fa-users"></i>
                    <select id="kelompok-siswa">
                        <option value="">-- Pilih Kelompok --</option>
                        <option value="1">Kelompok 1</option>
                        <option value="2">Kelompok 2</option>
                        <option value="3">Kelompok 3</option>
                        <option value="4">Kelompok 4</option>
                        <option value="5">Kelompok 5</option>
                    </select>
                </div>

                <div class="input-group">
                    <i class="fa-solid fa-user"></i>
                    <input type="text" id="nama-siswa" placeholder="Nama Anggota...">
                </div>

                <div style="display: flex; gap: 10px; align-items: center;">
                    <div class="date-badge">
                        <i class="fa-regular fa-calendar"></i>
                        <span id="tanggal"></span>
                    </div>
                    <div class="time-badge">
                        <i class="fa-regular fa-clock"></i>
                        <span id="waktu"></span>
                    </div>
                </div>
            </div>
        </header>

        <section class="pbl-phase" id="phase-1">
            <div class="phase-badge">Fase 1: Orientasi Masalah</div>
            <h2><i class="fa-solid fa-file-invoice-dollar"></i> Tagihan Listrik Membengkak!</h2>
            
            <div class="scenario-box">
                <p>Pak Andi adalah pelanggan PLN yang disiplin. Berikut data tagihan yang diterima:</p>
                <ul style="list-style: none; padding: 0;">
                    <li><i class="fa-solid fa-calendar-check"></i> <strong>Bulan 1 (Titik A):</strong> Pakai <strong>224 kWh</strong>, bayar <strong>Rp318.000</strong>.</li>
                    <li><i class="fa-solid fa-calendar-check"></i> <strong>Bulan 2 (Titik B):</strong> Pakai <strong>299 kWh</strong>, bayar <strong>Rp414.000</strong>.</li>
                </ul>
                <p><strong>Diketahui informasi grafik biaya listrik yang ditanggung Pak Andi:</strong></p>
                <ul style="margin: 5px 0 0 20px;">
                    <li><strong>Sumbu Y (Vertikal):</strong> Biaya listrik (satuan ribu Rupiah)</li>
                    <li><strong>Sumbu X (Horizontal):</strong> Banyaknya konsumsi listrik (kWh)</li>
                </ul>
                
                <div class="problem-statement">
                    <strong>Perdebatan:</strong><br>
                    <ul>
                        <li><strong>Pak Andi:</strong> "Kita harus hitung biaya listrik per-kWh dulu (Gradien)!"</li>
                        <li><strong>Bu Sintya:</strong> "Tidak perlu! Langsung masukkan kedua data ke rumus dua titik!"</li>
                    </ul>
                    <strong>Tantangan:</strong> Buktikan apakah kedua cara tersebut menghasilkan rumus yang sama!
                </div>

                <div class="coordinate-check">
                    <p><strong>Cek Koordinat:</strong> Masukkan koordinat titik A dan B.</p>
                    <div class="coord-input-group">
                        <label>Titik A:</label>
                        <input type="number" id="coordAx" placeholder="x" style="width: 60px;">
                        <input type="number" id="coordAy" placeholder="y" style="width: 60px;">
                        <button class="btn-check" onclick="checkCoordAnswer('A')">Cek A</button>
                    </div>
                    <div class="coord-input-group">
                        <label>Titik B:</label>
                        <input type="number" id="coordBx" placeholder="x" style="width: 60px;">
                        <input type="number" id="coordBy" placeholder="y" style="width: 60px;">
                        <button class="btn-check" onclick="checkCoordAnswer('B')">Cek B</button>
                    </div>
                    <div id="coordFeedback" class="feedback"></div>
                </div>
            </div>
        </section>

        <section class="pbl-phase chart-section">
            <h2><i class="fa-solid fa-chart-line"></i> Visualisasi Grafik Kartesius</h2>
            
            <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; border-left: 5px solid #4CAF50; margin-bottom: 15px;">
                <strong>Instruksi:</strong>
                <ul style="margin: 5px 0 0 20px;">
                    <li>Klik area grafik di bawah untuk membuat <strong>Titik A </strong> dan <strong>Titik B </strong>.</li>
                    <li>Gunakan <strong>Scroll Bar</strong> (di samping dan bawah grafik) untuk mencari posisi angka yang pas.</li>
                </ul>
            </div>

            <div class="chart-container">
                <div class="chart-controls">
                    <button id="undoBtn" class="btn-control" onclick="undoPoint()">Undo</button>
                    <button id="clearBtn" class="btn-control" onclick="clearAllPoints()">Hapus Semua</button>
                    <button id="checkGraphBtn" class="btn-control" onclick="checkGraphPoints()">Cek Grafik</button>
                </div>

                <div class="chart-scroll-wrapper">
                    <div class="chart-large-area">
                        <canvas id="myChart"></canvas>
                    </div>
                </div>
                
                <div id="graphFeedback" class="feedback"></div>
            </div>
        </section>

        <section class="pbl-phase" id="phase-3">
            <div class="phase-badge">Fase 2: Penyelidikan</div>
            <h2><i class="fa-solid fa-magnifying-glass-chart"></i> Duel Metode</h2>
            
            <p>Mari kita hitung menggunakan data yang sudah didapatkan. </p>

            <div class="formula-container">
                <div class="question-card scenario-card">
                    <div class="q-header">
                        <h3><i class="fa-solid fa-1"></i> Metode Bu Sintya (2 Titik)</h3>
                        <button class="btn-hint" onclick="toggleHint('2points')"><i class="fa-regular fa-lightbulb"></i> Bantuan</button>
                    </div>
                    <p class="q-text">Gunakan rumus dua titik untuk persamaan garis:</p>
                    <div class="math-step" style="font-size: 0.9rem;">
                        $$ \frac{y - y_1}{y_2 - y_1} = \frac{x - x_1}{x_2 - x_1} $$
                        <br>di mana \((x_1, y_1)\) adalah titik A dan \((x_2, y_2)\) adalah titik B.
                    </div>
                    <p>Sederhanakan persamaan, lalu temukan bentuk:</p>
                    <div class="math-step" style="font-size: 0.9rem;">
                        $$ y = mx + c $$
                    </div>
                    
                    <div id="hint2points" class="hint-box hidden">
                        <strong>Petunjuk Hitung:</strong> <br>
                        1. Substitusi nilai \( x_1, x_2, y_1, \) dan \( y_2 \).<br>
                        2. Sederhanakan persamaan tersebut menjadi bentuk \( y = mx + c \).<br>
                    </div>

                    <div class="answer-area">
                        <span>y = </span>
                        <input type="text" id="jawab_metode1" placeholder="cth: 1200x + 5000">
                        <button class="btn-check" onclick="checkAnswer('metode1')">Cek Bu Sintya</button>
                    </div>
                    <div id="feedback_metode1" class="feedback"></div>
                </div>

                <div class="question-card scenario-card">
                    <div class="q-header">
                        <h3><i class="fa-solid fa-2"></i> Metode Pak Andi (Gradien)</h3>
                        <button class="btn-hint" onclick="toggleHint('gradpoint')"><i class="fa-regular fa-lightbulb"></i> Bantuan</button>
                    </div>
                    <p class="q-text">Langkah 1: Hitung Biaya per kWh (Gradien / m).</p>
                    
                    <div class="sub-step">
                        <span>m = </span>
                        <input type="number" id="jawab_gradien" style="width: 100px;" placeholder="...">
                    </div>

                    <p class="q-text" style="margin-top:15px;">Langkah 2: Gunakan \(m\) dan titik A ke rumus:</p>
                    <div class="math-step" style="font-size: 0.9rem;">
                        $$ y - y_1 = m(x - x_1) $$
                    </div>

                    <div id="hintgradpoint" class="hint-box hidden">
                        <strong>Petunjuk:</strong> <br>
                        1. Hitung gradien (m) menggunakan rumus:
                        <div class="math-step" style="font-size: 0.8rem; margin: 5px 0;">
                            $$ m = \frac{y_2 - y_1}{x_2 - x_1} $$
                        </div>
                        2. Gunakan titik A sebagai \((x_1, y_1)\) dan m ke rumus:
                        <div class="math-step" style="font-size: 0.8rem; margin: 5px 0;">
                            $$ y - y_1 = m(x - x_1) $$
                        </div>
                        3. Sederhanakan untuk mendapatkan persamaan garis:
                        <div class="math-step" style="font-size: 0.8rem; margin-top: 5px;">
                            $$ y = mx + c $$
                        </div>
                    </div>

                    <div class="answer-area">
                        <span>y = </span>
                        <input type="text" id="jawab_metode2" placeholder="cth: 1200x + 5000">
                        <button class="btn-check" onclick="checkAnswer('metode2')">Cek Pak Andi</button>
                    </div>
                    <div id="feedback_metode2" class="feedback"></div>
                </div>
            </div>

            <div class="conclusion-box">
                <p><strong>Refleksi:</strong> Apakah kedua cara menghasilkan tarif yang sama?</p>
                <div class="answer-area" style="justify-content: center;">
                    <select id="jawab_kesimpulan">
                        <option value="">-- Pilih --</option>
                        <option value="Ya">Ya, Sama Persis</option>
                        <option value="Tidak">Tidak, Berbeda</option>
                    </select>
                    <button class="btn-check" onclick="checkAnswer('kesimpulan')">Kunci Jawaban</button>
                </div>
                <div id="feedback_kesimpulan" class="feedback"></div>
                <div id="reasonSection" class="hidden">
                    <p><strong>Berikan alasan mengapa kedua cara menghasilkan tarif yang berbeda:</strong></p>
                    <textarea id="reasonText" rows="4" placeholder="Jelaskan alasannya..."></textarea>
                    <button class="btn-check" onclick="submitReason()">Kirim Alasan</button>
                    <div id="reasonFeedback" class="feedback"></div>
                </div>
                <div id="finalEquationSection" class="hidden">
                    <p><strong>Tuliskan Persamaan Garis Lurus final yang akan diinput ke tagihan listrik:</strong></p>
                    <div class="answer-area">
                        <span>y = </span>
                        <input type="text" id="finalEquation" placeholder="cth: 1200x + 5000">
                        <button class="btn-check" onclick="checkFinalEquation()">Cek Persamaan</button>
                    </div>
                    <div id="finalFeedback" class="feedback"></div>
                </div>
            </div>
        </section>
        
        <section class="pbl-phase" id="phase-development">
            <div class="phase-badge">Fase 3: Pengembangan</div>
            <h2><i class="fa-solid fa-users-gear"></i> Diskusi & Analisis</h2>
            
            <p>Diskusikan dengan kelompokmu mengenai hubungan kedua metode yang telah kalian kerjakan.</p>

            <div class="question-card">
                <h3>1. Analisis Rumus</h3>
                <p>Perhatikan kembali Langkah 1 pada Pendapat Bu Sintya:</p>
                <div class="math-step">
                    $$ \frac{y - y_1}{y_2 - y_1} = \frac{x - x_1}{x_2 - x_1} $$
                </div>
                <p>Jika kamu mengalikan \( (y_2 - y_1) \) pada kedua ruas, rumusnya menjadi:</p>
                <div class="math-step">
                    $$ y - y_1 = \left( \frac{y_2 - y_1}{x_2 - x_1} \right) (x - x_1) $$
                </div>
                <p><strong>Pertanyaan:</strong> Bagian yang ada di dalam kurung \( \left( \frac{y_2 - y_1}{x_2 - x_1} \right) \) sebenarnya rumus untuk mencari apa?</p>
                
                <div class="answer-area">
                    <input type="text" id="devAnswer1" placeholder="Ketikan jawabanmu...">
                    <button class="btn-check" onclick="checkDevAnswer(1)">Cek Jawaban</button>
                </div>
                <div id="devFeedback1" class="feedback"></div>
            </div>

            <div class="question-card">
                <h3>2. Kesimpulan Penggunaan Metode</h3>
                <p>Menurut kalian, kapan waktu yang tepat untuk menggunakan pendapat <strong>Pak Andi</strong> dan kapan menggunakan pendapat <strong>Bu Sintya</strong>?</p>
                
                <textarea id="devAnswer2" rows="4" style="width: 100%; padding: 10px; border-radius: 8px; border: 2px solid #ddd; margin-top: 10px; font-family: 'Poppins', sans-serif;" placeholder="Tuliskan pendapat kelompokmu di sini..."></textarea>
                
                <div class="answer-area" style="margin-top: 10px;">
                    <button class="btn-check" onclick="checkDevAnswer(2)">Kirim Pendapat</button>
                </div>
                <div id="devFeedback2" class="feedback"></div>
            </div>
        </section>

        <section class="pbl-phase" id="phase-5">
            <div class="phase-badge">Fase Akhir: Uji Coba</div>
            <h2><i class="fa-solid fa-calculator"></i> Cek Kebenaran</h2>
            
            <div class="question-card">
                <p class="q-text">Jika bulan depan Pak Andi hanya memakai <strong>100 kWh</strong>, berapa tagihannya berdasarkan rumusmu? (tulis angka, tanpa titik atau koma).</p>
                <div class="answer-area">
                    <span>Rp </span>
                    <input type="number" id="jawab5" placeholder="Masukkan angka...">
                    <button class="btn-check" onclick="checkAnswer(5)">Cek Tagihan</button>
                </div>
                <div id="feedback5" class="feedback"></div>
            </div>

            <div class="question-card">
                <p class="q-text">Jika Pak Andi tidak menggunakan listrik sama sekali, apakah tetap dikenai tagihan?</p>
                <div class="answer-area" style="justify-content: center;">
                    <select id="jawab6">
                        <option value="">-- Pilih --</option>
                        <option value="Iya">Iya</option>
                        <option value="Tidak">Tidak</option>
                    </select>
                    <button class="btn-check" onclick="checkAnswer(6)">Jawab</button>
                </div>
                <div id="feedback6" class="feedback"></div>
                <div id="followup6" class="hidden">
                    <p id="followupQuestion6"></p>
                    <div class="answer-area">
                        <span id="prefix6" style="display: none;">Rp </span>
                        <input type="text" id="jawab6follow" placeholder="Masukkan angka...">
                        <button class="btn-check" onclick="checkAnswer('6.1')">Cek Jawaban</button>
                    </div>
                    <div id="feedback6follow" class="feedback"></div>
                </div>
            </div>
        </section>

        <div id="pointQuestionModal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close" onclick="closeModal()">&times;</span>
                <h3>Pertanyaan untuk Titik yang Dipilih</h3>
                <p id="questionText"></p>
                <div class="answer-area">
                    <input type="number" id="pointAnswer" placeholder="Masukkan jawaban...">
                    <button class="btn-check" onclick="checkPointAnswer()">Cek Jawaban</button>
                </div>
                <div id="pointFeedback" class="feedback"></div>
            </div>
        </div>

        <div id="confirmationModal" class="modal" style="display: none;">
            <div class="modal-content">
                <h3>Konfirmasi Jawaban</h3>
                <p>Apakah kamu yakin dengan semua jawaban ini?</p>
                <div class="answer-area" style="justify-content: center;">
                    <button class="btn-check" onclick="confirmSubmission()">Ya, Saya yakin</button>
                    <button class="btn-control" onclick="closeConfirmationModal()">Batal</button>
                </div>
            </div>
        </div>
        <section style="text-align: center; margin: 40px 0;">
    <button id="btnFinalSubmit" class="btn-check" 
            style="background: #FF9800; font-size: 1.2rem; padding: 15px 40px; box-shadow: 0 4px 10px rgba(255, 152, 0, 0.3);" 
            onclick="validateAndOpenModal()">
        <i class="fa-solid fa-paper-plane"></i> Selesai & Kumpulkan Jawaban
    </button>
</section>

<div id="confirmationModal" class="modal" style="display: none;">
    </div>

<footer class="main-footer">

        <footer class="main-footer">
            <p>&copy; 2026 E-LKPD Matematika Interaktif - Materi Persamaan Garis Lurus</p>
        </footer>
    </div>
    <script src="script.js?v=3"></script>
</body>
</html>